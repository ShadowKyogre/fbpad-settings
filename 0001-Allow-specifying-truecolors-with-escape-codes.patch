From 7a7cdb10569b968f54df98339a56df4d229597fa Mon Sep 17 00:00:00 2001
From: ShadowKyogre <shadowkyogre.public@gmail.com>
Date: Fri, 29 Apr 2016 13:32:48 -0700
Subject: [PATCH] Allow specifying truecolors with escape codes

---
 term.c | 20 ++++++++++++++++----
 1 file changed, 16 insertions(+), 4 deletions(-)

diff --git a/term.c b/term.c
index dd46d4a..4218c15 100644
--- a/term.c
+++ b/term.c
@@ -993,13 +993,25 @@ static void csiseq(void)
 			setattr(0);
 		for (i = 0; i < n; i++) {
 			if (args[i] == 38) {
-				fg = clrmap(args[i + 2]);
-				i += 2;
+				if (args[i + 1] == 2) {
+					fg = ((args[i + 2] << 16)|(args[i + 3] << 8)|args[i + 4]);
+					i += 5;
+				}
+				else {
+					fg = clrmap(args[i + 2]);
+					i += 2;
+				}
 				continue;
 			}
 			if (args[i] == 48) {
-				bg = clrmap(args[i + 2]);
-				i += 2;
+				if (args[i + 1] == 2) {
+					bg = ((args[i + 2] << 16)|(args[i + 3] << 8)|args[i + 4]);
+					i += 5;
+				}
+				else {
+					bg = clrmap(args[i + 2]);
+					i += 2;
+				}
 				continue;
 			}
 			setattr(args[i]);
-- 
2.8.0

